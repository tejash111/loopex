'use client'

import { useEffect, useState } from 'react'
import Sidebar from '@/components/dashboard/Sidebar'
import ProjectModal from '@/components/dashboard/ProjectModal'
import FilterModal from '@/components/dashboard/FilterModal'
import SearchBar from '@/components/dashboard/SearchBar'
import EmptyState from '@/components/dashboard/EmptyState'
import UploadJDModal from '@/components/dashboard/UploadJDModal'

const allProjectsIcon = <svg xmlns="http://www.w3.org/2000/svg" width="17" height="15" viewBox="0 0 17 15" fill="none">
  <path d="M6.15945 0.17913C5.6803 -0.000547886 5.14654 -0.000315414 4.37448 2.95864e-05C3.71543 2.20864e-05 3.05404 4.467e-05 2.62478 0.0378822C2.18247 0.0768747 1.79541 0.159345 1.44194 0.356602C0.986498 0.610762 0.61071 0.986557 0.35655 1.44199C0.159285 1.79547 0.0768152 2.18253 0.0378302 2.62483C-7.32858e-06 3.05409 -7.29317e-06 3.58563 2.06826e-07 4.24468V6.60556C-7.29317e-06 8.33686 -1.48192e-05 9.69369 0.142313 10.7523C0.287993 11.8358 0.591998 12.6908 1.26311 13.3619C1.93421 14.033 2.78923 14.3371 3.87278 14.4827C4.93139 14.6251 6.28817 14.6251 8.01945 14.6251H8.4375V9.37501C8.4375 8.44299 9.19305 7.68751 10.125 7.68751H16.125C16.125 7.63606 16.125 7.58416 16.125 7.53174C16.125 6.76749 16.125 6.08919 16.0748 5.59467C16.0228 5.08425 15.9127 4.6416 15.651 4.25002C15.4458 3.94292 15.1822 3.67924 14.8751 3.47405C14.4835 3.21241 14.0408 3.10227 13.5304 3.05035C13.0359 3.00004 12.4196 3.00005 11.6554 3.00006H8.98958C8.7525 3.00006 8.6172 2.99936 8.5173 2.98904C8.4408 2.98369 8.3886 2.92697 8.3721 2.89928C8.31818 2.81458 8.12535 2.42937 8.01937 2.21732C7.6653 1.50097 7.20607 0.571597 6.15945 0.17913Z" fill="#A0A0AB"/>
</svg>

const projectIcon = <svg xmlns="http://www.w3.org/2000/svg" width="17" height="15" viewBox="0 0 17 15" fill="none">
  <path d="M4.37448 2.87006e-05C5.14654 -0.000308799 5.6803 -0.000548769 6.15945 0.179129C7.20607 0.571596 7.6653 1.50097 8.01937 2.21733C8.12535 2.42938 8.31818 2.81458 8.3721 2.89928C8.3886 2.92697 8.4408 2.98369 8.5173 2.98904C8.6172 2.99937 8.7525 3.00006 8.98958 3.00006H11.6554C12.4196 3.00005 13.0359 3.00004 13.5304 3.05035C14.0408 3.10227 14.4835 3.21241 14.8751 3.47405C15.1822 3.67925 15.4458 3.94292 15.651 4.25002C15.9127 4.6416 16.0228 5.08426 16.0748 5.59468C16.125 6.08916 16.125 6.76753 16.125 7.53178C16.125 8.82156 16.125 9.83271 16.0431 10.6378C15.9596 11.4588 15.7862 12.1277 15.3983 12.7084C15.0836 13.1794 14.6793 13.5836 14.2084 13.8983C13.6277 14.2863 12.9587 14.4597 12.1377 14.5432C11.3326 14.6251 10.3215 14.6251 9.03172 14.6251H8.01945C6.28817 14.6251 4.93139 14.6251 3.87278 14.4828C2.78923 14.3371 1.93421 14.0331 1.26311 13.362C0.591998 12.6909 0.287993 11.8358 0.142313 10.7523C-1.48192e-05 9.69366 -7.28884e-06 8.33691 2.11162e-07 6.60561V4.24469C-7.28884e-06 3.58564 -1.4822e-05 3.0541 0.0378302 2.62483C0.0768152 2.18253 0.159285 1.79547 0.35655 1.44199C0.61071 0.986564 0.986498 0.610769 1.44194 0.356609C1.79541 0.159344 2.18247 0.0768813 2.62478 0.0378888C3.05404 5.12945e-05 3.71543 2.12006e-05 4.37448 2.87006e-05Z" fill="currentColor"/>
</svg>

const generalLinks = [
  { label: 'Shortlist', icon: <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
  <path d="M5.43383 9.71212C2.85767 10.3085 0.9375 12.6175 0.9375 15.375C0.9375 15.6856 1.18934 15.9375 1.5 15.9375H12C12.3106 15.9375 12.5625 15.6856 12.5625 15.375C12.5625 12.6175 10.6424 10.3085 8.06617 9.71212C9.59355 9.17055 10.6875 7.71308 10.6875 6C10.6875 3.82538 8.92462 2.0625 6.75 2.0625C4.57538 2.0625 2.8125 3.82538 2.8125 6C2.8125 7.71308 3.90643 9.17055 5.43383 9.71212Z" fill="#A0A0AB"/>
  <path d="M16.9778 6.4037C17.1691 6.77108 17.0264 7.224 16.659 7.41534C15.93 7.79505 15.2288 8.6022 14.6811 9.40088C14.4162 9.7872 14.2035 10.1472 14.0572 10.4104C13.9842 10.5416 13.8758 10.7525 13.8387 10.8247C13.7205 11.0708 13.4777 11.2335 13.2051 11.249C12.9323 11.2644 12.6727 11.1304 12.5274 10.8991C12.3728 10.6528 12.1179 10.4163 11.8677 10.2279C11.7479 10.1378 11.5314 10.0017 11.4546 9.95385C11.0908 9.75608 10.9559 9.30075 11.1535 8.93685C11.3512 8.5728 11.8065 8.43803 12.1706 8.63573C12.3377 8.72648 12.6085 8.90805 12.77 9.02963C12.8455 9.08655 12.9274 9.15113 13.0123 9.22298C13.1367 9.0174 13.2813 8.78985 13.444 8.55255C14.0214 7.7106 14.8952 6.64277 15.9661 6.08497C16.3335 5.89363 16.7864 6.03633 16.9778 6.4037Z" fill="#A0A0AB"/>
</svg> },
  { label: 'Email Automation', icon: <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M11.0117 2.0901C9.54487 2.05329 8.45513 2.0533 6.98828 2.0901L6.93214 2.09151C5.80012 2.11989 4.86871 2.14323 4.11798 2.27381C3.32121 2.4124 2.65407 2.6823 2.08902 3.2488C1.52692 3.81233 1.25779 4.46895 1.12144 5.25312C0.993487 5.98903 0.974122 6.89717 0.950684 7.99627L0.949477 8.05282C0.933502 8.80132 0.933509 9.19875 0.949492 9.94717L0.950699 10.0037C0.974129 11.1028 0.993494 12.0109 1.12145 12.7469C1.2578 13.531 1.52694 14.1877 2.08903 14.7512C2.65408 15.3177 3.32122 15.5876 4.11799 15.7262C4.86871 15.8568 5.80012 15.8801 6.93214 15.9085L6.98829 15.9099C8.45513 15.9467 9.54487 15.9467 11.0117 15.9099L11.0678 15.9085C12.1999 15.8801 13.1313 15.8567 13.882 15.7261C14.6788 15.5876 15.3459 15.3177 15.9109 14.7512C16.4731 14.1877 16.7422 13.531 16.8785 12.7468C17.0065 12.0109 17.0259 11.1028 17.0493 10.0037L17.0505 9.94717C17.0665 9.19867 17.0665 8.80132 17.0505 8.05282L17.0493 7.99635C17.0259 6.8972 17.0065 5.98903 16.8785 5.25312C16.7422 4.46895 16.4731 3.81233 15.9109 3.2488C15.5935 2.93046 15.2437 2.70577 14.8567 2.54541C14.7979 2.51328 14.7348 2.48904 14.669 2.47358C14.4217 2.38638 14.1597 2.32212 13.882 2.27382C13.1313 2.14323 12.1999 2.11989 11.0678 2.09151L11.0117 2.0901ZM15.5098 6.63772C15.4953 6.33359 15.488 6.18153 15.3779 6.12081C15.2678 6.0601 15.1324 6.13681 14.8616 6.29022L11.6848 8.09025C10.7101 8.64255 9.88575 9 8.99985 9C8.11395 9 7.28959 8.64255 6.31489 8.09025L3.13834 6.29039C2.86757 6.13697 2.73219 6.06026 2.62206 6.12097C2.51193 6.18168 2.50468 6.33375 2.49017 6.63789C2.47062 7.04778 2.46002 7.52295 2.44802 8.08477C2.4325 8.8119 2.4325 9.1881 2.44804 9.91522C2.47302 11.0852 2.49196 11.8795 2.59824 12.4907C2.69832 13.0663 2.86528 13.4083 3.15091 13.6946C3.43357 13.978 3.7802 14.1478 4.37516 14.2513C5.0038 14.3607 5.82373 14.3832 7.02593 14.4133C8.46765 14.4495 9.53235 14.4495 10.9741 14.4133C12.1763 14.3832 12.9962 14.3607 13.6249 14.2513C14.2198 14.1478 14.5664 13.978 14.8491 13.6946C15.1347 13.4083 15.3017 13.0663 15.4018 12.4907C15.508 11.8795 15.527 11.0852 15.552 9.91522C15.5675 9.1881 15.5675 8.8119 15.552 8.08477C15.54 7.52287 15.5293 7.04765 15.5098 6.63772Z" fill="#A0A0AB"/>
</svg> },
  { label: 'Career Page', icon: <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M13.1824 1.81514C12.1274 1.68749 10.7738 1.68749 9.03915 1.6875C7.3045 1.68749 5.87261 1.68749 4.81766 1.81514C3.74417 1.94504 2.89452 2.21519 2.22206 2.82041C1.54111 3.43327 1.22931 4.2206 1.08097 5.2136C0.937478 6.17416 0.937485 7.49567 0.9375 9.04688C0.937485 10.5981 0.937478 11.8259 1.08097 12.7864C1.22931 13.7794 1.54111 14.5667 2.22206 15.1796C2.89452 15.7848 3.74417 16.0549 4.81766 16.1848C5.87261 16.3125 7.30451 16.3125 9.03915 16.3125C10.7738 16.3125 12.1274 16.3125 13.1824 16.1848C14.2558 16.0549 15.1054 15.7848 15.778 15.1796C16.4589 14.5667 16.7707 13.7794 16.919 12.7864C17.0625 11.8259 17.0625 10.5981 17.0625 9.04688C17.0625 7.4957 17.0625 6.17416 16.919 5.2136C16.7707 4.2206 16.4589 3.43327 15.778 2.82041C15.1054 2.21519 14.2558 1.94504 13.1824 1.81514ZM7.03332 5.46449C6.83194 5.43742 6.58698 5.43746 6.33131 5.4375H5.6687C5.41304 5.43746 5.16807 5.43742 4.9667 5.46449C4.74093 5.49485 4.4878 5.5682 4.27799 5.77799C4.0682 5.9878 3.99485 6.24093 3.96449 6.46669C3.93742 6.66807 3.93746 6.91303 3.93751 7.16869V7.83127C3.93746 8.08687 3.93742 8.33197 3.96449 8.53335C3.99485 8.7591 4.0682 9.01222 4.27799 9.222C4.4878 9.43185 4.74093 9.5052 4.9667 9.5355C5.16807 9.56257 5.41304 9.56257 5.66871 9.5625H6.33131C6.58698 9.56257 6.83194 9.56257 7.03332 9.5355C7.25909 9.5052 7.51222 9.43185 7.722 9.222C7.93185 9.01222 8.0052 8.7591 8.0355 8.53335C8.06257 8.33197 8.06257 8.08695 8.0625 7.83127V7.16871C8.06257 6.91303 8.06257 6.66807 8.0355 6.46669C8.0052 6.24093 7.93185 5.9878 7.722 5.77799C7.51222 5.5682 7.25909 5.49485 7.03332 5.46449ZM3.9375 12C3.9375 11.6894 4.18934 11.4375 4.5 11.4375H7.5C7.81065 11.4375 8.0625 11.6894 8.0625 12C8.0625 12.3106 7.81065 12.5625 7.5 12.5625H4.5C4.18934 12.5625 3.9375 12.3106 3.9375 12ZM10.5 5.4375C10.1894 5.4375 9.9375 5.68934 9.9375 6C9.9375 6.31066 10.1894 6.5625 10.5 6.5625H13.5C13.8106 6.5625 14.0625 6.31066 14.0625 6C14.0625 5.68934 13.8106 5.4375 13.5 5.4375H10.5ZM9.9375 9C9.9375 8.68935 10.1894 8.4375 10.5 8.4375H13.5C13.8106 8.4375 14.0625 8.68935 14.0625 9C14.0625 9.31065 13.8106 9.5625 13.5 9.5625H10.5C10.1894 9.5625 9.9375 9.31065 9.9375 9ZM10.5 11.4375C10.1894 11.4375 9.9375 11.6894 9.9375 12C9.9375 12.3106 10.1894 12.5625 10.5 12.5625H13.5C13.8106 12.5625 14.0625 12.3106 14.0625 12C14.0625 11.6894 13.8106 11.4375 13.5 11.4375H10.5Z" fill="#A0A0AB"/>
</svg> },
  { label: 'Messaging', icon: <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.33474 1.36705C8.42767 1.29439 9.57007 1.29424 10.6653 1.36705C14.0902 1.59472 16.8077 4.35943 17.0312 7.8168C17.0729 8.4636 17.0729 9.1326 17.0312 9.7794C16.8077 13.2367 14.0902 16.0015 10.6653 16.2292C9.57007 16.3019 8.42767 16.3018 7.33474 16.2292C6.91104 16.201 6.44983 16.1008 6.04379 15.9336C5.86522 15.86 5.74401 15.8103 5.65531 15.7777C5.59432 15.8197 5.51331 15.8792 5.39535 15.9662C4.80102 16.4044 4.05069 16.7119 2.98588 16.686L2.95158 16.6852C2.74616 16.6802 2.52721 16.675 2.34864 16.6405C2.13356 16.5988 1.86747 16.4948 1.70093 16.2109C1.51967 15.9019 1.59235 15.5893 1.66266 15.3925C1.72902 15.2068 1.84405 14.9889 1.96156 14.7664L1.97767 14.7358C2.32742 14.0731 2.42485 13.5314 2.23786 13.1703C1.61361 12.228 1.05204 11.0667 0.968848 9.7794C0.927051 9.1326 0.927051 8.4636 0.968848 7.8168C1.19229 4.35943 3.90975 1.59472 7.33474 1.36705ZM5.8125 7.125C5.8125 7.43566 6.06434 7.6875 6.375 7.6875H9C9.31065 7.6875 9.5625 7.43566 9.5625 7.125C9.5625 6.81434 9.31065 6.5625 9 6.5625H6.375C6.06434 6.5625 5.8125 6.81434 5.8125 7.125ZM5.8125 10.875C5.8125 11.1856 6.06434 11.4375 6.375 11.4375H11.625C11.9356 11.4375 12.1875 11.1856 12.1875 10.875C12.1875 10.5643 11.9356 10.3125 11.625 10.3125H6.375C6.06434 10.3125 5.8125 10.5643 5.8125 10.875Z" fill="#A0A0AB"/>
</svg>, badge: '10' }
]

const supportLinks = [
  { label: 'Support', icon: <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M9.00015 3C6.56164 3 4.73617 4.57114 4.52137 6.39047C4.61297 6.42977 4.70126 6.47013 4.78126 6.50675C5.04837 6.62609 5.55204 6.85111 5.74388 7.41893C5.81364 7.6254 5.81309 7.8462 5.81258 8.05163V11.4484C5.81309 11.6538 5.81364 11.8745 5.74388 12.0811C5.55204 12.6489 5.04837 12.8739 4.78126 12.9932C4.50907 13.1178 4.141 13.2858 3.87271 13.3076C3.57469 13.3316 3.27297 13.268 3.01118 13.121C2.77343 12.9876 2.59494 12.7699 2.41415 12.5492C2.34878 12.4699 2.22503 12.3239 2.13812 12.2231C1.97922 12.039 1.79879 11.83 1.65004 11.6353C1.4043 11.3137 1.15805 10.9283 1.03573 10.4806C0.904755 10.0011 0.904755 9.4989 1.03573 9.01942C1.12449 8.69452 1.28509 8.4078 1.49708 8.10682C1.70238 7.81538 2.05203 7.38823 2.39404 6.97283C2.44918 6.9029 2.52499 6.80677 2.58104 6.74257C2.68255 6.62629 2.82301 6.48456 3.01118 6.37895L3.0147 6.37697C3.23514 3.56214 5.93306 1.5 9.00015 1.5C12.0673 1.5 14.7652 3.56214 14.9857 6.37698L14.9891 6.37895C15.1773 6.48456 15.3178 6.62629 15.4193 6.74257C15.4753 6.80677 15.5512 6.90289 15.6063 6.97283C15.9483 7.38823 16.2979 7.81538 16.5033 8.10682C16.7153 8.4078 16.8758 8.69452 16.9646 9.01942C17.0956 9.4989 17.0956 10.0011 16.9646 10.4806C16.8423 10.9283 16.5961 11.3137 16.3503 11.6353C16.2016 11.83 16.0212 12.039 15.8623 12.2231C15.7754 12.3239 15.6516 12.4699 15.5862 12.5492C15.4082 12.7663 15.2324 12.9809 15.0002 13.1148V13.35C15.0002 15.2372 13.1564 16.5 11.2502 16.5H9.75015C9.33593 16.5 9.00015 16.1642 9.00015 15.75C9.00015 15.3358 9.33593 15 9.75015 15H11.2502C12.6576 15 13.5002 14.1137 13.5002 13.35V13.1185C13.401 13.0765 13.3052 13.0327 13.2191 12.9932C12.952 12.8739 12.4483 12.6489 12.2565 12.0811C12.1867 11.8745 12.1873 11.6538 12.1877 11.4484V8.05163C12.1873 7.8462 12.1867 7.6254 12.2565 7.41893C12.4483 6.85111 12.952 6.62609 13.2191 6.50675C13.2991 6.47013 13.3874 6.42977 13.479 6.39047C13.2642 4.57114 11.4387 3 9.00015 3Z" fill="#A0A0AB"/>
</svg> },
  { label: 'Settings', icon: <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
  <g clip-path="url(#clip0_3193_10049)">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M9.1317 0.942427C9.04403 0.935858 8.95597 0.935858 8.8683 0.942427C8.4906 0.970732 8.18452 1.14116 7.90485 1.35997C7.64182 1.56578 7.35081 1.8568 7.01047 2.19717L6.43993 2.68567C6.43993 2.68567 6.13398 2.72546 5.64951 2.72546C5.1161 2.72543 4.66018 2.7254 4.29585 2.77439C3.90683 2.82669 3.53914 2.94395 3.24155 3.24155C2.94395 3.53914 2.82669 3.90683 2.77439 4.29585C2.7254 4.66018 2.72543 5.1161 2.72546 5.64951L2.68567 6.43993L2.19717 7.01047C1.85682 7.35079 1.56577 7.64182 1.35997 7.90485C1.14116 8.18452 0.970732 8.4906 0.942427 8.8683C0.935858 8.95597 0.935858 9.04403 0.942427 9.1317C0.970732 9.5094 1.14116 9.81548 1.35997 10.0951C1.56578 10.3582 1.8568 10.6492 2.19717 10.9895L2.68567 11.5601L2.72546 12.3505C2.72543 12.8839 2.7254 13.3398 2.77439 13.7041C2.82669 14.0932 2.94395 14.4608 3.24155 14.7584C3.53914 15.056 3.90683 15.1733 4.29585 15.2256C4.66018 15.2746 5.11611 15.2746 5.64952 15.2746L6.43993 15.3143L7.01047 15.8028C7.35078 16.1432 7.64182 16.4342 7.90485 16.64C8.18452 16.8589 8.4906 17.0293 8.8683 17.0576C8.95597 17.0641 9.04403 17.0641 9.1317 17.0576C9.5094 17.0293 9.81548 16.8589 10.0951 16.64C10.3582 16.4342 10.6492 16.1432 10.9895 15.8028L11.5601 15.3143L12.3505 15.2746C12.8839 15.2746 13.3398 15.2746 13.7041 15.2256C14.0932 15.1733 14.4608 15.056 14.7584 14.7584C15.056 14.4608 15.1733 14.0932 15.2256 13.7041C15.2746 13.3398 15.2746 12.8839 15.2746 12.3505L15.3143 11.5601L15.8029 10.9895C16.1432 10.6492 16.4342 10.3582 16.64 10.0951C16.8589 9.81548 17.0293 9.5094 17.0576 9.1317C17.0641 9.04403 17.0641 8.95597 17.0576 8.8683C17.0293 8.4906 16.8589 8.18452 16.64 7.90485C16.4342 7.64182 16.1432 7.3508 15.8028 7.01045L15.3143 6.43993L15.2746 5.64952C15.2746 5.11611 15.2746 4.66018 15.2256 4.29585C15.1733 3.90683 15.056 3.53914 14.7584 3.24155C14.4608 2.94395 14.0932 2.82669 13.7041 2.77439C13.3398 2.7254 12.8839 2.72543 12.3505 2.72546C11.8661 2.72546 11.516 2.66744 11.516 2.66744L10.9895 2.19717C10.6492 1.8568 10.3582 1.56578 10.0951 1.35997C9.81548 1.14116 9.5094 0.970732 9.1317 0.942427ZM9 5.8125C7.23959 5.8125 5.8125 7.23959 5.8125 9C5.8125 10.7604 7.23959 12.1875 9 12.1875C10.7604 12.1875 12.1875 10.7604 12.1875 9C12.1875 7.23959 10.7604 5.8125 9 5.8125Z" fill="#A0A0AB"/>
  </g>
  <defs>
    <clipPath id="clip0_3193_10049">
      <rect width="18" height="18" fill="white"/>
    </clipPath>
  </defs>
</svg> }
]

export default function Dashboard() {
  const [showModal, setShowModal] = useState(false)
  const [projectName, setProjectName] = useState('')
  const [userProjects, setUserProjects] = useState<string[]>([])
  const [selectedProject, setSelectedProject] = useState<string | null>(null)
  const [searchInput, setSearchInput] = useState('')
  const [showFilterModal, setShowFilterModal] = useState(false)
  const [showUploadJDModal, setShowUploadJDModal] = useState(false)

  // Show modal if no projects exist and fetch projects on mount
  useEffect(() => {
    fetchUserProjects()
  }, [])

  useEffect(() => {
    if (userProjects.length === 0) {
      setShowModal(true)
    }
  }, [userProjects.length])

  const fetchUserProjects = async () => {
    try {
      const token = localStorage.getItem('authToken')
      if (!token) {
        console.error('No auth token found')
        return
      }

      const response = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/api/projects`, {
        headers: {
          'Authorization': `Bearer ${token}`
        }
      })

      const data = await response.json()

      if (data.success) {
        setUserProjects(data.projects.map((p: any) => p.name))
        if (data.projects.length > 0 && !selectedProject) {
          setSelectedProject(data.projects[0].name)
        }
      }
    } catch (error) {
      console.error('Error fetching projects:', error)
    }
  }

  const handleCreateProject = async () => {
    if (projectName.trim()) {
      try {
        const token = localStorage.getItem('authToken')
        if (!token) {
          console.error('No auth token found')
          return
        }

        const response = await fetch('http://localhost:5000/api/projects', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify({ name: projectName.trim() })
        })

        const data = await response.json()

        if (data.success) {
          const newProject = projectName.trim()
          setUserProjects([...userProjects, newProject])
          setSelectedProject(newProject)
          setProjectName('')
          setShowModal(false)
        } else {
          alert(data.message || 'Failed to create project')
        }
      } catch (error) {
        console.error('Error creating project:', error)
        alert('Failed to create project. Please try again.')
      }
    }
  }

  // Removed unused useMemo hooks that referenced non-existent functions

  return (
    <div className="min-h-screen flex px-[16px] py-[12px]" style={{ backgroundColor: '#1a1a1e' }}>
      {/* Sidebar */}
      <Sidebar
        showModal={showModal}
        showFilterModal={showFilterModal}
        selectedProject={selectedProject}
        userProjects={userProjects}
        onNewProject={() => setShowModal(true)}
        onProjectSelect={setSelectedProject}
      />

      {/* Main content */}
      <main className={`flex-1 relative overflow-hidden bg-[#131316] rounded-2xl transition-all duration-300 ${showModal || showFilterModal ? 'blur-[2px]' : ''}`}>
        <div className="relative z-10 h-full flex flex-col items-center justify-center text-white">
          <EmptyState />
          <SearchBar
            searchInput={searchInput}
            setSearchInput={setSearchInput}
            onFilterClick={() => setShowFilterModal(true)}
            onUploadJDClick={() => setShowUploadJDModal(true)}
          />
        </div>
      </main>

      {/* Modals */}
      <ProjectModal
        isOpen={showModal}
        onClose={() => setShowModal(false)}
        projectName={projectName}
        setProjectName={setProjectName}
        onCreateProject={handleCreateProject}
      />

      <FilterModal
        isOpen={showFilterModal}
        onClose={() => setShowFilterModal(false)}
      />

      <UploadJDModal 
        isOpen={showUploadJDModal} 
        onClose={() => setShowUploadJDModal(false)} 
      />
    </div>
  )
}
